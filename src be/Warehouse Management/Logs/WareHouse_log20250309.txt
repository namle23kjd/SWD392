2025-03-09 12:56:48.240 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 12:56:48.261 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 12:56:48.262 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 12:56:48.365 +07:00 [ERR] An error occurred while seeding the database: The ConnectionString property has not been initialized.
2025-03-09 12:56:48.376 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 12:56:48.432 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 12:56:48.433 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 12:56:48.488 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 12:56:48.490 +07:00 [INF] Hosting environment: Development
2025-03-09 12:56:48.491 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 12:56:48.781 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 12:56:48.904 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 123.5484ms
2025-03-09 12:56:48.945 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 12:56:48.945 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 12:56:48.945 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 12:56:48.949 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 4.2295ms
2025-03-09 12:56:48.958 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 12.5794ms
2025-03-09 12:56:48.988 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.9674ms
2025-03-09 12:56:49.345 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 12:56:49.363 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 17.586ms
2025-03-09 13:32:03.787 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:32:03.812 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:32:03.813 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:32:03.981 +07:00 [ERR] An error occurred while seeding the database: The ConnectionString property has not been initialized.
2025-03-09 13:32:04.013 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 13:32:04.207 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 13:32:04.209 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 13:32:04.287 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 13:32:04.288 +07:00 [INF] Hosting environment: Development
2025-03-09 13:32:04.289 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 13:32:04.463 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 13:32:04.602 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 144.1176ms
2025-03-09 13:32:04.621 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 13:32:04.621 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 13:32:04.625 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 13:32:04.631 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 9.9637ms
2025-03-09 13:32:04.634 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 13.628ms
2025-03-09 13:32:04.664 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 39.2043ms
2025-03-09 13:32:04.829 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 13:32:04.847 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 18.4967ms
2025-03-09 13:32:08.135 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:32:08.195 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:32:08.208 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:32:08.215 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 3.0272ms
2025-03-09 13:32:08.218 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:32:08.271 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 500 null application/json 136.3818ms
2025-03-09 13:34:47.187 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:34:47.216 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:34:47.218 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:34:47.388 +07:00 [ERR] An error occurred while seeding the database: The ConnectionString property has not been initialized.
2025-03-09 13:34:47.413 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 13:34:47.548 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 13:34:47.549 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 13:34:47.610 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 13:34:47.611 +07:00 [INF] Hosting environment: Development
2025-03-09 13:34:47.611 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 13:34:48.198 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 13:34:48.322 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 132.2903ms
2025-03-09 13:34:48.337 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 13:34:48.337 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 13:34:48.342 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 13:34:48.342 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 5.1429ms
2025-03-09 13:34:48.351 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 14.4021ms
2025-03-09 13:34:48.378 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.0972ms
2025-03-09 13:34:48.542 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 13:34:48.566 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 24.4126ms
2025-03-09 13:34:51.214 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:34:51.264 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:34:51.281 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:34:51.500 +07:00 [ERR] An error occurred using the connection to database '' on server ''.
2025-03-09 13:34:51.526 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'Warehouse_Management.Data.WareHouseDbContext'.
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: The ConnectionString property has not been initialized.
   at Microsoft.Data.SqlClient.SqlConnection.PermissionDemand()
   at Microsoft.Data.SqlClient.SqlConnectionFactory.PermissionDemand(DbConnection outerConnection)
   at Microsoft.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   at Microsoft.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry, SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open(SqlConnectionOverrides overrides)
   at Microsoft.Data.SqlClient.SqlConnection.Open()
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerConnection.OpenDbConnection(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.<>c.<MoveNext>b__21_0(DbContext _, Enumerator enumerator)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2025-03-09 13:35:15.443 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:35:15.464 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:35:15.465 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:35:15.728 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:35:15.745 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:35:15.756 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:35:15.852 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:35:15.855 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-09 13:35:15.867 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-09 13:35:15.899 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-09 13:35:15.906 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:35:15.907 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:35:15.909 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:35:15.917 +07:00 [INF] Applying migration '20250304035722_Fix enitity StockTransaction'.
2025-03-09 13:35:15.969 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-03-09 13:35:16.032 +07:00 [ERR] An error occurred while seeding the database: There is already an object named 'AspNetRoles' in the database.
2025-03-09 13:35:16.048 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 13:35:16.182 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 13:35:16.183 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 13:35:16.276 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 13:35:16.277 +07:00 [INF] Hosting environment: Development
2025-03-09 13:35:16.278 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 13:35:16.625 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 13:35:16.738 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 119.2184ms
2025-03-09 13:35:16.752 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 13:35:16.753 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 13:35:16.757 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 13:35:16.759 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 7.0385ms
2025-03-09 13:35:16.771 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 18.7802ms
2025-03-09 13:35:16.794 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.7738ms
2025-03-09 13:35:16.958 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 13:35:16.975 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 17.1298ms
2025-03-09 13:35:21.627 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:35:21.706 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:35:21.717 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:35:21.914 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 13:35:21.937 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 13:35:21.945 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 13:35:21.953 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 13:35:21.967 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 243.621ms
2025-03-09 13:35:21.969 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:35:21.975 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 348.1793ms
2025-03-09 13:40:45.759 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/login - application/json 69
2025-03-09 13:40:45.766 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:40:45.769 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:40:45.783 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Warehouse_Management.Models.DTO.LoginRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:40:45.989 +07:00 [INF] Login attempt for username: tiendatq9@gmail.com
2025-03-09 13:40:46.181 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:40:46.406 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 13:40:46.445 +07:00 [INF] Login successful for user: tiendatq9@gmail.com
2025-03-09 13:40:46.448 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:40:46.468 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Login (Warehouse Management) in 683.7255ms
2025-03-09 13:40:46.471 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:40:46.474 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/login - 200 null application/json; charset=utf-8 714.7111ms
2025-03-09 13:42:31.661 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/register - application/json 98
2025-03-09 13:42:31.673 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:42:31.721 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:42:31.726 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Warehouse_Management.Models.DTO.RegisterRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:42:31.747 +07:00 [INF] Registration attempt for username: khanhaaa@gmail.com
2025-03-09 13:42:31.844 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:42:31.942 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 21), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Discriminator], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [Status], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-03-09 13:42:31.967 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-03-09 13:42:31.991 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:42:32.019 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-03-09 13:42:32.026 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:42:32.041 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:42:32.074 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p17='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p18='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [LockoutEnabled] = @p6, [LockoutEnd] = @p7, [NormalizedEmail] = @p8, [NormalizedUserName] = @p9, [PasswordHash] = @p10, [PhoneNumber] = @p11, [PhoneNumberConfirmed] = @p12, [SecurityStamp] = @p13, [Status] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-03-09 13:42:32.088 +07:00 [INF] Registration successful for user: khanhaaa@gmail.com
2025-03-09 13:42:32.091 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:42:32.101 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Register (Warehouse Management) in 372.7463ms
2025-03-09 13:42:32.102 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:42:32.104 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/register - 200 null application/json; charset=utf-8 445.4478ms
2025-03-09 13:42:37.623 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:42:37.627 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:42:37.628 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:42:37.633 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 13:42:37.635 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 13:42:37.638 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 13:42:37.640 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 13:42:37.641 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 11.6403ms
2025-03-09 13:42:37.642 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:42:37.644 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 20.9852ms
2025-03-09 13:42:46.733 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Auth - null null
2025-03-09 13:42:46.736 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 13:42:46.741 +07:00 [INF] Route matched with {action = "GetAllUser", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUser() on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:42:46.767 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
2025-03-09 13:42:46.779 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 13:42:46.784 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 13:42:46.786 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:42:46.792 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management) in 48.6966ms
2025-03-09 13:42:46.793 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 13:42:46.795 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Auth - 200 null application/json; charset=utf-8 61.9495ms
2025-03-09 13:43:28.630 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Platform - application/json 80
2025-03-09 13:43:28.637 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:43:28.638 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management)'
2025-03-09 13:43:28.641 +07:00 [INF] Route matched with {action = "CreatePlatform", controller = "Platform"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePlatform(Warehouse_Management.Models.DTO.Platform.CreatePlatformDTO) on controller Warehouse_Management.Controllers.PlatformController (Warehouse Management).
2025-03-09 13:43:28.694 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Platforms] ([ApiKey], [IsActive], [Name])
OUTPUT INSERTED.[PlatformId]
VALUES (@p0, @p1, @p2);
2025-03-09 13:43:28.711 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:43:28.714 +07:00 [INF] Executed action Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management) in 69.6157ms
2025-03-09 13:43:28.720 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management)'
2025-03-09 13:43:28.721 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Platform - 201 null application/json; charset=utf-8 91.1825ms
2025-03-09 13:43:56.826 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 225
2025-03-09 13:43:56.832 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:43:56.833 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:43:56.837 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:43:56.861 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:43:56.863 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:43:56.877 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:43:56.893 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:43:56.895 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:43:56.896 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 57.9561ms
2025-03-09 13:43:56.897 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:43:56.899 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 400 null application/json; charset=utf-8 73.1287ms
2025-03-09 13:44:02.268 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 225
2025-03-09 13:44:02.270 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:44:02.271 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:44:02.272 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:44:02.277 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:44:02.277 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:44:02.281 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:44:02.285 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:44:02.382 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:44:02.427 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:44:02.430 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:44:02.431 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 157.727ms
2025-03-09 13:44:02.433 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:44:02.434 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 400 null application/json; charset=utf-8 166.3266ms
2025-03-09 13:44:09.806 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Product?pageName=1&pageSize=10 - null null
2025-03-09 13:44:09.809 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.GetAllProducts (Warehouse Management)'
2025-03-09 13:44:09.815 +07:00 [INF] Route matched with {action = "GetAllProducts", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllProducts(Int32, Int32) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 13:44:09.837 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 13:44:09.847 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:44:09.848 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:44:09.896 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p0].[ProductId], [p0].[Barcode], [p0].[BasePrice], [p0].[CreatedAt], [p0].[Description], [p0].[ProductName], [p0].[SKU], [p0].[UpdatedAt], [p0].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status], [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId]
FROM (
    SELECT [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
    FROM [Products] AS [p]
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [p0]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [p0].[UserId] = [a0].[Id]
LEFT JOIN [Lots] AS [l] ON [p0].[ProductId] = [l].[ProductId]
ORDER BY [p0].[ProductId], [a0].[Id]
2025-03-09 13:44:09.921 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:44:09.940 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.GetAllProducts (Warehouse Management) in 123.4071ms
2025-03-09 13:44:09.941 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.GetAllProducts (Warehouse Management)'
2025-03-09 13:44:09.943 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Product?pageName=1&pageSize=10 - 200 null application/json; charset=utf-8 136.8309ms
2025-03-09 13:46:13.155 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Shelf - application/json 97
2025-03-09 13:46:13.166 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:46:13.167 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 13:46:13.172 +07:00 [INF] Route matched with {action = "CreateShelf", controller = "Shelf"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateShelf(Warehouse_Management.Models.DTO.Shelf.CreateShelfDTO) on controller Warehouse_Management.Controllers.ShelfController (Warehouse Management).
2025-03-09 13:46:13.186 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:46:13.214 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__code_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Shelves] AS [s]
        WHERE [s].[Code] = @__code_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 13:46:13.235 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Shelves] ([Capacity], [Code], [CreatedAt], [IsActive], [Location], [Name], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ShelfId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 13:46:13.243 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:46:13.246 +07:00 [INF] Executed action Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management) in 72.6003ms
2025-03-09 13:46:13.247 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 13:46:13.249 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Shelf - 201 null application/json; charset=utf-8 94.0229ms
2025-03-09 13:47:15.414 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:47:15.437 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:47:15.438 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:47:15.710 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:47:15.725 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:47:15.734 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:47:15.836 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:47:15.840 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-09 13:47:15.843 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-09 13:47:15.875 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-09 13:47:15.880 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:47:15.882 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:47:15.884 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:47:15.891 +07:00 [INF] Applying migration '20250304035722_Fix enitity StockTransaction'.
2025-03-09 13:47:15.938 +07:00 [ERR] Failed executing DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-03-09 13:47:15.957 +07:00 [ERR] An error occurred while seeding the database: There is already an object named 'AspNetRoles' in the database.
2025-03-09 13:47:15.977 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 13:47:16.120 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 13:47:16.121 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 13:47:16.203 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 13:47:16.204 +07:00 [INF] Hosting environment: Development
2025-03-09 13:47:16.206 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 13:47:16.418 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 13:47:16.534 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 123.5387ms
2025-03-09 13:47:16.547 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 13:47:16.547 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 13:47:16.552 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 5.068ms
2025-03-09 13:47:16.553 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 13:47:16.561 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 14.469ms
2025-03-09 13:47:16.595 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 42.1373ms
2025-03-09 13:47:16.802 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 13:47:16.823 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 21.8033ms
2025-03-09 13:47:46.823 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Lot - application/json 171
2025-03-09 13:47:46.835 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:47:46.935 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.LotController.CreateLot (Warehouse Management)'
2025-03-09 13:47:46.961 +07:00 [INF] Route matched with {action = "CreateLot", controller = "Lot"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateLot(Warehouse_Management.Models.DTO.Lot.CreateLotDTO) on controller Warehouse_Management.Controllers.LotController (Warehouse Management).
2025-03-09 13:47:47.579 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:47:47.684 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:47:47.803 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Shelves] AS [s]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s].[UserId] = [a0].[Id]
WHERE [s].[ShelfId] = @__id_0
2025-03-09 13:47:47.985 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Lots] ([CreateAt], [ExpiryDate], [LotCode], [ManufactureDate], [ProductId], [Quantity], [ShelfId], [Status], [UpdateAt], [UserId])
OUTPUT INSERTED.[LotId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-03-09 13:47:48.021 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:47:48.044 +07:00 [INF] Executed action Warehouse_Management.Controllers.LotController.CreateLot (Warehouse Management) in 1076.212ms
2025-03-09 13:47:48.046 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.LotController.CreateLot (Warehouse Management)'
2025-03-09 13:47:48.054 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Lot - 201 null application/json; charset=utf-8 1232.6457ms
2025-03-09 13:48:37.068 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Platform - null null
2025-03-09 13:48:37.083 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.PlatformController.GetAllPlatforms (Warehouse Management)'
2025-03-09 13:48:37.089 +07:00 [INF] Route matched with {action = "GetAllPlatforms", controller = "Platform"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllPlatforms() on controller Warehouse_Management.Controllers.PlatformController (Warehouse Management).
2025-03-09 13:48:37.157 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PlatformId], [p].[ApiKey], [p].[IsActive], [p].[Name]
FROM [Platforms] AS [p]
2025-03-09 13:48:37.188 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:48:37.195 +07:00 [INF] Executed action Warehouse_Management.Controllers.PlatformController.GetAllPlatforms (Warehouse Management) in 102.9519ms
2025-03-09 13:48:37.197 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.PlatformController.GetAllPlatforms (Warehouse Management)'
2025-03-09 13:48:37.198 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Platform - 200 null application/json; charset=utf-8 133.8826ms
2025-03-09 13:48:55.529 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:48:55.538 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:48:55.544 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:48:55.548 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:48:55.573 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:48:55.574 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:48:55.583 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:48:55.588 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:48:55.632 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:48:55.645 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:48:55.648 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:48:55.650 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 99.3524ms
2025-03-09 13:48:55.651 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:48:55.658 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 400 null application/json; charset=utf-8 129.2222ms
2025-03-09 13:49:53.032 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Supplier?pageNumber=1&pageSize=10 - null null
2025-03-09 13:49:53.038 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management)'
2025-03-09 13:49:53.043 +07:00 [INF] Route matched with {action = "GetAllSuppliers", controller = "Supplier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSuppliers(Int32, Int32) on controller Warehouse_Management.Controllers.SupplierController (Warehouse Management).
2025-03-09 13:49:53.086 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Suppliers] AS [s]
WHERE [s].[IsDeleted] = CAST(0 AS bit)
2025-03-09 13:49:53.099 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:49:53.101 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:49:53.110 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[IsDeleted] = CAST(0 AS bit)
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-09 13:49:53.133 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:49:53.145 +07:00 [INF] Executed action Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management) in 100.4325ms
2025-03-09 13:49:53.147 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management)'
2025-03-09 13:49:53.149 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Supplier?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 116.6173ms
2025-03-09 13:50:19.674 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 265
2025-03-09 13:50:19.686 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:50:19.688 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:50:19.693 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 13:50:19.713 +07:00 [INF] Fetching Supplier with ID: 5
2025-03-09 13:50:19.724 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 13:50:19.742 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 13:50:19.763 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 13:50:19.797 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:50:19.917 +07:00 [ERR] An error occurred while processing the product creation: An error occurred while saving the entity changes. See the inner exception for details.
2025-03-09 13:50:19.933 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:50:19.935 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 240.1521ms
2025-03-09 13:50:19.936 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:50:19.937 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 500 null application/json; charset=utf-8 263.4065ms
2025-03-09 13:50:35.842 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 295
2025-03-09 13:50:35.847 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:50:35.848 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:50:35.850 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 13:50:35.854 +07:00 [INF] Fetching Supplier with ID: 5
2025-03-09 13:50:35.860 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 13:50:35.864 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 13:50:35.871 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 13:50:35.880 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Shelves] AS [s]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s].[UserId] = [a0].[Id]
WHERE [s].[ShelfId] = @__id_0
2025-03-09 13:50:35.888 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:50:35.894 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Lots] ([CreateAt], [ExpiryDate], [LotCode], [ManufactureDate], [ProductId], [Quantity], [ShelfId], [Status], [UpdateAt], [UserId])
OUTPUT INSERTED.[LotId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-03-09 13:50:35.899 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:50:35.937 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-03-09 13:50:35.952 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
2025-03-09 13:50:35.956 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:50:35.959 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 106.4509ms
2025-03-09 13:50:35.961 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:50:35.962 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 201 null application/json; charset=utf-8 120.4627ms
2025-03-09 13:51:02.759 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:51:02.769 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:51:02.770 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:02.772 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:51:02.775 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:51:02.776 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:51:02.781 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:51:02.788 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:51:02.796 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:02.800 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:02.815 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 13:51:02.826 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:51:02.913 +07:00 [ERR] Error occurred in OrderService
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Warehouse_Management.Repositories.Repository.StockTransactionRepository.SaveChangesAsync() in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Repositories\Repository\StockTransactionRepository.cs:line 76
   at Warehouse_Management.Services.Service.OrderService.CreateOrderAsync(CreateOrderDTO orderDto) in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Services\Service\OrderService.cs:line 141
2025-03-09 13:51:02.946 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:51:02.948 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 174.2339ms
2025-03-09 13:51:02.949 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:02.951 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 500 null application/json; charset=utf-8 192.717ms
2025-03-09 13:51:08.117 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:51:08.122 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:51:08.123 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:08.124 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:51:08.139 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:51:08.140 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:51:08.144 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:51:08.148 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:51:08.151 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:08.155 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:08.160 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 13:51:08.166 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:51:08.237 +07:00 [ERR] Error occurred in OrderService
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Warehouse_Management.Repositories.Repository.StockTransactionRepository.SaveChangesAsync() in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Repositories\Repository\StockTransactionRepository.cs:line 76
   at Warehouse_Management.Services.Service.OrderService.CreateOrderAsync(CreateOrderDTO orderDto) in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Services\Service\OrderService.cs:line 141
2025-03-09 13:51:08.246 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:51:08.247 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 120.8345ms
2025-03-09 13:51:08.248 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:08.250 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 500 null application/json; charset=utf-8 132.6037ms
2025-03-09 13:51:11.128 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:51:11.131 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:51:11.134 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:11.136 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:51:11.139 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:51:11.140 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:51:11.145 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:51:11.148 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:51:11.152 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:11.155 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:11.160 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 13:51:11.166 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:51:11.239 +07:00 [ERR] Error occurred in OrderService
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Warehouse_Management.Repositories.Repository.StockTransactionRepository.SaveChangesAsync() in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Repositories\Repository\StockTransactionRepository.cs:line 76
   at Warehouse_Management.Services.Service.OrderService.CreateOrderAsync(CreateOrderDTO orderDto) in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Services\Service\OrderService.cs:line 141
2025-03-09 13:51:11.247 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:51:11.248 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 109.9164ms
2025-03-09 13:51:11.250 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:11.251 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 500 null application/json; charset=utf-8 123.0246ms
2025-03-09 13:51:12.425 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:51:12.427 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:51:12.429 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:12.430 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:51:12.432 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:51:12.433 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:51:12.438 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:51:12.446 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:51:12.453 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:12.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:51:12.464 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 13:51:12.470 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:51:12.550 +07:00 [ERR] Error occurred in OrderService
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Warehouse_Management.Repositories.Repository.StockTransactionRepository.SaveChangesAsync() in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Repositories\Repository\StockTransactionRepository.cs:line 76
   at Warehouse_Management.Services.Service.OrderService.CreateOrderAsync(CreateOrderDTO orderDto) in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Services\Service\OrderService.cs:line 141
2025-03-09 13:51:12.558 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:51:12.559 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 127.8114ms
2025-03-09 13:51:12.560 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:51:12.561 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 500 null application/json; charset=utf-8 137.0261ms
2025-03-09 13:51:18.061 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:51:18.064 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:51:18.067 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:51:18.079 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 13:51:18.086 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 13:51:18.092 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 13:51:18.095 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 13:51:18.098 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 29.7116ms
2025-03-09 13:51:18.099 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:51:18.101 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 40.1912ms
2025-03-09 13:52:23.308 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 298
2025-03-09 13:52:23.318 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:52:23.320 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:52:23.322 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 13:52:23.327 +07:00 [INF] Fetching Supplier with ID: 5
2025-03-09 13:52:23.333 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 13:52:23.338 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 13:52:23.340 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:52:23.341 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 17.2798ms
2025-03-09 13:52:23.348 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:52:23.349 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 400 null application/json; charset=utf-8 41.2513ms
2025-03-09 13:52:31.298 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 298
2025-03-09 13:52:31.300 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:52:31.301 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:52:31.303 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 13:52:31.305 +07:00 [INF] Fetching Supplier with ID: 5
2025-03-09 13:52:31.307 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 13:52:31.312 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 13:52:31.319 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 13:52:31.325 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Shelves] AS [s]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s].[UserId] = [a0].[Id]
WHERE [s].[ShelfId] = @__id_0
2025-03-09 13:52:31.334 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:52:31.340 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Lots] ([CreateAt], [ExpiryDate], [LotCode], [ManufactureDate], [ProductId], [Quantity], [ShelfId], [Status], [UpdateAt], [UserId])
OUTPUT INSERTED.[LotId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-03-09 13:52:31.344 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:52:31.350 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-03-09 13:52:31.355 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
2025-03-09 13:52:31.358 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:52:31.359 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 55.1306ms
2025-03-09 13:52:31.361 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 13:52:31.362 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 201 null application/json; charset=utf-8 64.6093ms
2025-03-09 13:52:39.924 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 227
2025-03-09 13:52:39.931 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:52:39.932 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:52:39.935 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 13:52:39.937 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 13:52:39.938 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 13:52:39.942 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 13:52:39.951 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 13:52:39.954 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:52:39.958 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 13:52:39.966 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 13:52:39.973 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 13:52:40.051 +07:00 [ERR] Error occurred in OrderService
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'SupplierId', table 'WarehouseManagerment.dbo.StockTransactions'; column does not allow nulls. INSERT fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:81a61923-e3f5-44bc-a6f3-d5657acbbaf4
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Warehouse_Management.Repositories.Repository.StockTransactionRepository.SaveChangesAsync() in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Repositories\Repository\StockTransactionRepository.cs:line 76
   at Warehouse_Management.Services.Service.OrderService.CreateOrderAsync(CreateOrderDTO orderDto) in C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management\Services\Service\OrderService.cs:line 141
2025-03-09 13:52:40.060 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:52:40.061 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 124.5339ms
2025-03-09 13:52:40.063 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 13:52:40.065 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 500 null application/json; charset=utf-8 140.9656ms
2025-03-09 13:53:27.940 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:27.956 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:27.957 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:42.956 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:42.974 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:42.975 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:53:43.236 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:53:43.245 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-09 13:53:43.255 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-09 13:53:43.285 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-09 13:53:43.289 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:53:43.289 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:53:43.292 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:53:43.297 +07:00 [INF] Applying migration '20250309065328_tdat'.
2025-03-09 13:53:43.335 +07:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-03-09 13:54:42.405 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:42.421 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:42.421 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:42.658 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:54:42.666 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-09 13:54:42.674 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-09 13:54:42.704 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-09 13:54:42.708 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:54:42.708 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:54:42.710 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:54:42.716 +07:00 [INF] Applying migration '20250309065328_tdat'.
2025-03-09 13:54:42.752 +07:00 [ERR] Failed executing DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] nvarchar(450) NOT NULL,
    [Discriminator] nvarchar(21) NOT NULL,
    [Status] bit NULL,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [LockoutEnd] datetimeoffset NULL,
    [LockoutEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2025-03-09 13:54:52.918 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:52.934 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:52.934 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:58.066 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:58.083 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:58.083 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:54:58.227 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:55:01.283 +07:00 [INF] Executed DbCommand (3,034ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [WarehouseManagerment] SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
END;
2025-03-09 13:55:01.323 +07:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
DROP DATABASE [WarehouseManagerment];
2025-03-09 13:55:10.240 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:10.256 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:10.256 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:28.026 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:28.041 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:28.042 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:30.319 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:30.335 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:30.335 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:37.530 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:37.546 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:37.547 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:44.482 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:44.498 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:44.498 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:55:44.851 +07:00 [INF] Executed DbCommand (101ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
CREATE DATABASE [WarehouseManagerment];
2025-03-09 13:55:44.883 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
IF SERVERPROPERTY('EngineEdition') <> 5
BEGIN
    ALTER DATABASE [WarehouseManagerment] SET READ_COMMITTED_SNAPSHOT ON;
END;
2025-03-09 13:55:44.894 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:55:44.896 +07:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2025-03-09 13:55:44.908 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_getapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session', @LockMode = 'Exclusive';
SELECT @result
2025-03-09 13:55:44.940 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF OBJECT_ID(N'[__EFMigrationsHistory]') IS NULL
BEGIN
    CREATE TABLE [__EFMigrationsHistory] (
        [MigrationId] nvarchar(150) NOT NULL,
        [ProductVersion] nvarchar(32) NOT NULL,
        CONSTRAINT [PK___EFMigrationsHistory] PRIMARY KEY ([MigrationId])
    );
END;
2025-03-09 13:55:44.945 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:55:44.945 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:55:44.952 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:55:44.958 +07:00 [INF] Applying migration '20250309065537_tdat'.
2025-03-09 13:55:44.996 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoles] (
    [Id] nvarchar(450) NOT NULL,
    [Name] nvarchar(256) NULL,
    [NormalizedName] nvarchar(256) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoles] PRIMARY KEY ([Id])
);
2025-03-09 13:55:44.998 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUsers] (
    [Id] nvarchar(450) NOT NULL,
    [Discriminator] nvarchar(21) NOT NULL,
    [Status] bit NULL,
    [UserName] nvarchar(256) NULL,
    [NormalizedUserName] nvarchar(256) NULL,
    [Email] nvarchar(256) NULL,
    [NormalizedEmail] nvarchar(256) NULL,
    [EmailConfirmed] bit NOT NULL,
    [PasswordHash] nvarchar(max) NULL,
    [SecurityStamp] nvarchar(max) NULL,
    [ConcurrencyStamp] nvarchar(max) NULL,
    [PhoneNumber] nvarchar(max) NULL,
    [PhoneNumberConfirmed] bit NOT NULL,
    [TwoFactorEnabled] bit NOT NULL,
    [LockoutEnd] datetimeoffset NULL,
    [LockoutEnabled] bit NOT NULL,
    [AccessFailedCount] int NOT NULL,
    CONSTRAINT [PK_AspNetUsers] PRIMARY KEY ([Id])
);
2025-03-09 13:55:45.184 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Platforms] (
    [PlatformId] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NULL,
    [ApiKey] nvarchar(max) NULL,
    [IsActive] bit NOT NULL,
    CONSTRAINT [PK_Platforms] PRIMARY KEY ([PlatformId])
);
2025-03-09 13:55:45.186 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Suppliers] (
    [SupplierId] int NOT NULL IDENTITY,
    [Name] nvarchar(max) NULL,
    [Email] nvarchar(max) NULL,
    [Phone] nvarchar(max) NULL,
    [CreateAt] datetime2 NULL,
    [IsDeleted] bit NOT NULL,
    CONSTRAINT [PK_Suppliers] PRIMARY KEY ([SupplierId])
);
2025-03-09 13:55:45.188 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetRoleClaims] (
    [Id] int NOT NULL IDENTITY,
    [RoleId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetRoleClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetRoleClaims_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE
);
2025-03-09 13:55:45.189 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserClaims] (
    [Id] int NOT NULL IDENTITY,
    [UserId] nvarchar(450) NOT NULL,
    [ClaimType] nvarchar(max) NULL,
    [ClaimValue] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserClaims] PRIMARY KEY ([Id]),
    CONSTRAINT [FK_AspNetUserClaims_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-03-09 13:55:47.105 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserLogins] (
    [LoginProvider] nvarchar(450) NOT NULL,
    [ProviderKey] nvarchar(450) NOT NULL,
    [ProviderDisplayName] nvarchar(max) NULL,
    [UserId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserLogins] PRIMARY KEY ([LoginProvider], [ProviderKey]),
    CONSTRAINT [FK_AspNetUserLogins_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-03-09 13:55:47.106 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserRoles] (
    [UserId] nvarchar(450) NOT NULL,
    [RoleId] nvarchar(450) NOT NULL,
    CONSTRAINT [PK_AspNetUserRoles] PRIMARY KEY ([UserId], [RoleId]),
    CONSTRAINT [FK_AspNetUserRoles_AspNetRoles_RoleId] FOREIGN KEY ([RoleId]) REFERENCES [AspNetRoles] ([Id]) ON DELETE CASCADE,
    CONSTRAINT [FK_AspNetUserRoles_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-03-09 13:55:47.107 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [AspNetUserTokens] (
    [UserId] nvarchar(450) NOT NULL,
    [LoginProvider] nvarchar(450) NOT NULL,
    [Name] nvarchar(450) NOT NULL,
    [Value] nvarchar(max) NULL,
    CONSTRAINT [PK_AspNetUserTokens] PRIMARY KEY ([UserId], [LoginProvider], [Name]),
    CONSTRAINT [FK_AspNetUserTokens_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]) ON DELETE CASCADE
);
2025-03-09 13:55:47.109 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Products] (
    [ProductId] int NOT NULL IDENTITY,
    [SKU] nvarchar(max) NULL,
    [Barcode] nvarchar(max) NULL,
    [ProductName] nvarchar(max) NULL,
    [Description] nvarchar(max) NULL,
    [BasePrice] decimal(18,2) NULL,
    [CreatedAt] datetime2 NULL,
    [UpdatedAt] datetime2 NULL,
    [UserId] nvarchar(450) NULL,
    CONSTRAINT [PK_Products] PRIMARY KEY ([ProductId]),
    CONSTRAINT [FK_Products_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id])
);
2025-03-09 13:55:48.230 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Shelves] (
    [ShelfId] int NOT NULL IDENTITY,
    [Code] nvarchar(max) NULL,
    [Name] nvarchar(max) NULL,
    [Location] nvarchar(max) NULL,
    [Capacity] int NOT NULL,
    [IsActive] bit NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    [UpdatedAt] datetime2 NOT NULL,
    [UserId] nvarchar(450) NULL,
    CONSTRAINT [PK_Shelves] PRIMARY KEY ([ShelfId]),
    CONSTRAINT [FK_Shelves_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id])
);
2025-03-09 13:55:48.233 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Orders] (
    [OrderId] int NOT NULL IDENTITY,
    [PlatformId] int NOT NULL,
    [PlatformOrderId] nvarchar(max) NULL,
    [OrderStatus] bit NOT NULL,
    [OrderDate] datetime2 NOT NULL,
    [TotalAmount] decimal(18,2) NOT NULL,
    [CreatedAt] datetime2 NOT NULL,
    CONSTRAINT [PK_Orders] PRIMARY KEY ([OrderId]),
    CONSTRAINT [FK_Orders_Platforms_PlatformId] FOREIGN KEY ([PlatformId]) REFERENCES [Platforms] ([PlatformId]) ON DELETE CASCADE
);
2025-03-09 13:55:48.235 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [Lots] (
    [LotId] int NOT NULL IDENTITY,
    [ProductId] int NOT NULL,
    [ShelfId] int NOT NULL,
    [LotCode] nvarchar(max) NULL,
    [Quantity] int NOT NULL,
    [ManufactureDate] datetime2 NOT NULL,
    [ExpiryDate] datetime2 NOT NULL,
    [Status] bit NOT NULL,
    [CreateAt] datetime2 NOT NULL,
    [UpdateAt] datetime2 NOT NULL,
    [UserId] nvarchar(450) NULL,
    CONSTRAINT [PK_Lots] PRIMARY KEY ([LotId]),
    CONSTRAINT [FK_Lots_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]),
    CONSTRAINT [FK_Lots_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE,
    CONSTRAINT [FK_Lots_Shelves_ShelfId] FOREIGN KEY ([ShelfId]) REFERENCES [Shelves] ([ShelfId]) ON DELETE CASCADE
);
2025-03-09 13:55:49.375 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [OrderItems] (
    [OrderItemId] int NOT NULL IDENTITY,
    [OrderId] int NOT NULL,
    [ProductId] int NOT NULL,
    [Quantity] int NOT NULL,
    [UnitPrice] decimal(18,2) NOT NULL,
    CONSTRAINT [PK_OrderItems] PRIMARY KEY ([OrderItemId]),
    CONSTRAINT [FK_OrderItems_Orders_OrderId] FOREIGN KEY ([OrderId]) REFERENCES [Orders] ([OrderId]) ON DELETE CASCADE,
    CONSTRAINT [FK_OrderItems_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE
);
2025-03-09 13:55:49.380 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE [StockTransactions] (
    [TransactionId] int NOT NULL IDENTITY,
    [ProductId] int NOT NULL,
    [SupplierId] int NULL,
    [LotId] int NOT NULL,
    [UserId] nvarchar(450) NULL,
    [Quantity] int NOT NULL,
    [Type] nvarchar(max) NULL,
    [TransactionDate] datetime2 NOT NULL,
    CONSTRAINT [PK_StockTransactions] PRIMARY KEY ([TransactionId]),
    CONSTRAINT [FK_StockTransactions_AspNetUsers_UserId] FOREIGN KEY ([UserId]) REFERENCES [AspNetUsers] ([Id]),
    CONSTRAINT [FK_StockTransactions_Lots_LotId] FOREIGN KEY ([LotId]) REFERENCES [Lots] ([LotId]) ON DELETE NO ACTION,
    CONSTRAINT [FK_StockTransactions_Products_ProductId] FOREIGN KEY ([ProductId]) REFERENCES [Products] ([ProductId]) ON DELETE CASCADE,
    CONSTRAINT [FK_StockTransactions_Suppliers_SupplierId] FOREIGN KEY ([SupplierId]) REFERENCES [Suppliers] ([SupplierId]) ON DELETE NO ACTION
);
2025-03-09 13:55:50.766 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ConcurrencyStamp', N'Name', N'NormalizedName') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] ON;
INSERT INTO [AspNetRoles] ([Id], [ConcurrencyStamp], [Name], [NormalizedName])
VALUES (N'373e112e-121b-4f3f-bb3e-dc30c08b9999', N'373e112e-121b-4f3f-bb3e-dc30c08b9999', N'Admin', N'ADMIN'),
(N'9116bb38-85b1-4345-bf4a-7c0819a8ef3b', N'9116bb38-85b1-4345-bf4a-7c0819a8ef3b', N'Staff', N'STAFF'),
(N'b1234567-89ab-cdef-0123-456789abcdef', N'b1234567-89ab-cdef-0123-456789abcdef', N'Manager', N'MANAGER');
IF EXISTS (SELECT * FROM [sys].[identity_columns] WHERE [name] IN (N'Id', N'ConcurrencyStamp', N'Name', N'NormalizedName') AND [object_id] = OBJECT_ID(N'[AspNetRoles]'))
    SET IDENTITY_INSERT [AspNetRoles] OFF;
2025-03-09 13:55:50.769 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetRoleClaims_RoleId] ON [AspNetRoleClaims] ([RoleId]);
2025-03-09 13:55:50.783 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [RoleNameIndex] ON [AspNetRoles] ([NormalizedName]) WHERE [NormalizedName] IS NOT NULL;
2025-03-09 13:55:50.784 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserClaims_UserId] ON [AspNetUserClaims] ([UserId]);
2025-03-09 13:55:50.785 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserLogins_UserId] ON [AspNetUserLogins] ([UserId]);
2025-03-09 13:55:50.786 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_AspNetUserRoles_RoleId] ON [AspNetUserRoles] ([RoleId]);
2025-03-09 13:55:51.728 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [EmailIndex] ON [AspNetUsers] ([NormalizedEmail]);
2025-03-09 13:55:51.729 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX [UserNameIndex] ON [AspNetUsers] ([NormalizedUserName]) WHERE [NormalizedUserName] IS NOT NULL;
2025-03-09 13:55:51.730 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Lots_ProductId] ON [Lots] ([ProductId]);
2025-03-09 13:55:51.731 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Lots_ShelfId] ON [Lots] ([ShelfId]);
2025-03-09 13:55:51.732 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Lots_UserId] ON [Lots] ([UserId]);
2025-03-09 13:55:51.732 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OrderItems_OrderId] ON [OrderItems] ([OrderId]);
2025-03-09 13:55:51.733 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_OrderItems_ProductId] ON [OrderItems] ([ProductId]);
2025-03-09 13:55:51.733 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Orders_PlatformId] ON [Orders] ([PlatformId]);
2025-03-09 13:55:51.734 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Products_UserId] ON [Products] ([UserId]);
2025-03-09 13:55:51.734 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_Shelves_UserId] ON [Shelves] ([UserId]);
2025-03-09 13:55:51.735 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_StockTransactions_LotId] ON [StockTransactions] ([LotId]);
2025-03-09 13:55:51.736 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_StockTransactions_ProductId] ON [StockTransactions] ([ProductId]);
2025-03-09 13:55:52.274 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_StockTransactions_SupplierId] ON [StockTransactions] ([SupplierId]);
2025-03-09 13:55:52.275 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX [IX_StockTransactions_UserId] ON [StockTransactions] ([UserId]);
2025-03-09 13:55:52.276 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250309065537_tdat', N'9.0.1');
2025-03-09 13:55:52.278 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DECLARE @result int;
EXEC @result = sp_releaseapplock @Resource = '__EFMigrationsLock', @LockOwner = 'Session';
SELECT @result
2025-03-09 13:56:35.069 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:56:35.098 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:56:35.099 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 13:56:35.327 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 13:56:35.343 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 13:56:35.352 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 13:56:35.506 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Products] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 13:56:35.616 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 13:56:35.631 +07:00 [INF] 1 products have been seeded into the database.
2025-03-09 13:56:35.651 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 13:56:35.790 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 13:56:35.791 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 13:56:35.865 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 13:56:35.866 +07:00 [INF] Hosting environment: Development
2025-03-09 13:56:35.867 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 13:56:36.139 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 13:56:36.264 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 132.5674ms
2025-03-09 13:56:36.276 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 13:56:36.276 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 13:56:36.280 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 4.2224ms
2025-03-09 13:56:36.290 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 14.5799ms
2025-03-09 13:56:36.294 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 13:56:36.329 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 35.6229ms
2025-03-09 13:56:36.611 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 13:56:36.630 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 19.9308ms
2025-03-09 13:56:40.259 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 13:56:40.309 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:56:40.320 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 13:56:40.356 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 13:56:40.364 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 13:56:40.369 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 13:56:40.375 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 13:56:40.382 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 57.389ms
2025-03-09 13:56:40.384 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 13:56:40.387 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 128.2052ms
2025-03-09 13:57:19.383 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/register - application/json 100
2025-03-09 13:57:19.397 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:57:19.400 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:57:19.414 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Warehouse_Management.Models.DTO.RegisterRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:57:19.631 +07:00 [INF] Registration attempt for username: tiendaatq9@gmail.com
2025-03-09 13:57:19.899 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:57:20.016 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 21), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Discriminator], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [Status], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-03-09 13:57:20.039 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-03-09 13:57:20.068 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:57:20.096 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-03-09 13:57:20.105 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:57:20.129 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:57:20.170 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p17='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p18='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [LockoutEnabled] = @p6, [LockoutEnd] = @p7, [NormalizedEmail] = @p8, [NormalizedUserName] = @p9, [PasswordHash] = @p10, [PhoneNumber] = @p11, [PhoneNumberConfirmed] = @p12, [SecurityStamp] = @p13, [Status] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-03-09 13:57:20.184 +07:00 [INF] Registration successful for user: tiendaatq9@gmail.com
2025-03-09 13:57:20.187 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:57:20.210 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Register (Warehouse Management) in 794.2095ms
2025-03-09 13:57:20.213 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:57:20.215 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/register - 200 null application/json; charset=utf-8 833.2472ms
2025-03-09 13:57:40.343 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/register - application/json 98
2025-03-09 13:57:40.349 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:57:40.351 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:57:40.352 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Warehouse_Management.Models.DTO.RegisterRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:57:40.366 +07:00 [INF] Registration attempt for username: khanhhaa@gmail.com
2025-03-09 13:57:40.445 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:57:40.451 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 21), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Discriminator], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [Status], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-03-09 13:57:40.454 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-03-09 13:57:40.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:57:40.461 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-03-09 13:57:40.465 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:57:40.469 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:57:40.474 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p17='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p18='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [LockoutEnabled] = @p6, [LockoutEnd] = @p7, [NormalizedEmail] = @p8, [NormalizedUserName] = @p9, [PasswordHash] = @p10, [PhoneNumber] = @p11, [PhoneNumberConfirmed] = @p12, [SecurityStamp] = @p13, [Status] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-03-09 13:57:40.476 +07:00 [INF] Registration successful for user: khanhhaa@gmail.com
2025-03-09 13:57:40.477 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:57:40.479 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Register (Warehouse Management) in 124.5893ms
2025-03-09 13:57:40.481 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:57:40.482 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/register - 200 null application/json; charset=utf-8 140.8735ms
2025-03-09 13:57:55.516 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/login - application/json 69
2025-03-09 13:57:55.519 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:57:55.520 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:57:55.526 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Warehouse_Management.Models.DTO.LoginRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:57:55.542 +07:00 [INF] Login attempt for username: tiendatq9@gmail.com
2025-03-09 13:57:55.547 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:57:55.549 +07:00 [WRN] Login failed - User not found: tiendatq9@gmail.com
2025-03-09 13:57:55.551 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:57:55.553 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Login (Warehouse Management) in 25.2591ms
2025-03-09 13:57:55.554 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:57:55.555 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/login - 401 null application/json; charset=utf-8 40.1573ms
2025-03-09 13:58:12.558 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/login - application/json 69
2025-03-09 13:58:12.560 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:58:12.561 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:12.562 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Warehouse_Management.Models.DTO.LoginRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:58:12.565 +07:00 [INF] Login attempt for username: tiendatq9@gmail.com
2025-03-09 13:58:12.569 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:58:12.572 +07:00 [WRN] Login failed - User not found: tiendatq9@gmail.com
2025-03-09 13:58:12.573 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:58:12.575 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Login (Warehouse Management) in 10.5423ms
2025-03-09 13:58:12.576 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:12.578 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/login - 401 null application/json; charset=utf-8 20.8883ms
2025-03-09 13:58:28.972 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/login - application/json 70
2025-03-09 13:58:28.975 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:58:28.976 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:28.977 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Warehouse_Management.Models.DTO.LoginRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:58:28.980 +07:00 [INF] Login attempt for username: tiendaatq9@gmail.com
2025-03-09 13:58:28.984 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:58:29.115 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 13:58:29.149 +07:00 [INF] Login successful for user: tiendaatq9@gmail.com
2025-03-09 13:58:29.150 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:58:29.156 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Login (Warehouse Management) in 177.3695ms
2025-03-09 13:58:29.158 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:29.159 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/login - 200 null application/json; charset=utf-8 187.4103ms
2025-03-09 13:58:47.934 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/register - application/json 99
2025-03-09 13:58:47.936 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:58:47.937 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:58:47.939 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Warehouse_Management.Models.DTO.RegisterRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:58:47.942 +07:00 [INF] Registration attempt for username: tiendatq9@gmail.com
2025-03-09 13:58:48.019 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:58:48.025 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (DbType = Int32), @p2='?' (Size = 4000), @p3='?' (Size = 21), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [AspNetUsers] ([Id], [AccessFailedCount], [ConcurrencyStamp], [Discriminator], [Email], [EmailConfirmed], [LockoutEnabled], [LockoutEnd], [NormalizedEmail], [NormalizedUserName], [PasswordHash], [PhoneNumber], [PhoneNumberConfirmed], [SecurityStamp], [Status], [TwoFactorEnabled], [UserName])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14, @p15, @p16);
2025-03-09 13:58:48.031 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedName_0
2025-03-09 13:58:48.035 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:58:48.039 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450), @__p_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[UserId], [a].[RoleId]
FROM [AspNetUserRoles] AS [a]
WHERE [a].[UserId] = @__p_0 AND [a].[RoleId] = @__p_1
2025-03-09 13:58:48.042 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedRoleName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(2) [a].[Id], [a].[ConcurrencyStamp], [a].[Name], [a].[NormalizedName]
FROM [AspNetRoles] AS [a]
WHERE [a].[NormalizedName] = @__normalizedRoleName_0
2025-03-09 13:58:48.046 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:58:48.054 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 450), @p1='?' (Size = 450), @p17='?' (Size = 450), @p2='?' (DbType = Int32), @p3='?' (Size = 4000), @p18='?' (Size = 4000), @p4='?' (Size = 256), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?' (DbType = DateTimeOffset), @p8='?' (Size = 256), @p9='?' (Size = 256), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = Boolean), @p13='?' (Size = 4000), @p14='?' (DbType = Boolean), @p15='?' (DbType = Boolean), @p16='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [AspNetUserRoles] ([RoleId], [UserId])
VALUES (@p0, @p1);
UPDATE [AspNetUsers] SET [AccessFailedCount] = @p2, [ConcurrencyStamp] = @p3, [Email] = @p4, [EmailConfirmed] = @p5, [LockoutEnabled] = @p6, [LockoutEnd] = @p7, [NormalizedEmail] = @p8, [NormalizedUserName] = @p9, [PasswordHash] = @p10, [PhoneNumber] = @p11, [PhoneNumberConfirmed] = @p12, [SecurityStamp] = @p13, [Status] = @p14, [TwoFactorEnabled] = @p15, [UserName] = @p16
OUTPUT 1
WHERE [Id] = @p17 AND [ConcurrencyStamp] = @p18;
2025-03-09 13:58:48.057 +07:00 [INF] Registration successful for user: tiendatq9@gmail.com
2025-03-09 13:58:48.058 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:58:48.060 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Register (Warehouse Management) in 118.9552ms
2025-03-09 13:58:48.061 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Register (Warehouse Management)'
2025-03-09 13:58:48.062 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/register - 200 null application/json; charset=utf-8 128.9976ms
2025-03-09 13:58:54.080 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Auth/login - application/json 69
2025-03-09 13:58:54.083 +07:00 [INF] CORS policy execution successful.
2025-03-09 13:58:54.084 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:54.085 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Warehouse_Management.Models.DTO.LoginRequestDTO) on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 13:58:54.088 +07:00 [INF] Login attempt for username: tiendatq9@gmail.com
2025-03-09 13:58:54.093 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__normalizedUserName_0='?' (Size = 256)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[NormalizedUserName] = @__normalizedUserName_0
2025-03-09 13:58:54.172 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 13:58:54.175 +07:00 [INF] Login successful for user: tiendatq9@gmail.com
2025-03-09 13:58:54.176 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:58:54.177 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.Login (Warehouse Management) in 89.8479ms
2025-03-09 13:58:54.178 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.Login (Warehouse Management)'
2025-03-09 13:58:54.180 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Auth/login - 200 null application/json; charset=utf-8 99.4296ms
2025-03-09 13:59:39.463 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Supplier?pageNumber=1&pageSize=10 - null null
2025-03-09 13:59:39.519 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management)'
2025-03-09 13:59:39.525 +07:00 [INF] Route matched with {action = "GetAllSuppliers", controller = "Supplier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSuppliers(Int32, Int32) on controller Warehouse_Management.Controllers.SupplierController (Warehouse Management).
2025-03-09 13:59:39.551 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Suppliers] AS [s]
WHERE [s].[IsDeleted] = CAST(0 AS bit)
2025-03-09 13:59:39.564 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:59:39.566 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 13:59:39.574 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[IsDeleted] = CAST(0 AS bit)
ORDER BY (SELECT 1)
OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
2025-03-09 13:59:39.585 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 13:59:39.594 +07:00 [INF] Executed action Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management) in 67.3784ms
2025-03-09 13:59:39.596 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.SupplierController.GetAllSuppliers (Warehouse Management)'
2025-03-09 13:59:39.597 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Supplier?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 134.3387ms
2025-03-09 14:00:00.476 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Supplier - application/json 76
2025-03-09 14:00:00.484 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:00:00.486 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.SupplierController.CreateSupplier (Warehouse Management)'
2025-03-09 14:00:00.491 +07:00 [INF] Route matched with {action = "CreateSupplier", controller = "Supplier"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateSupplier(Warehouse_Management.Models.DTO.Supplier.CreateSupplierDTO) on controller Warehouse_Management.Controllers.SupplierController (Warehouse Management).
2025-03-09 14:00:00.509 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[Email] = @__email_0
2025-03-09 14:00:00.552 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = Boolean), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Suppliers] ([CreateAt], [Email], [IsDeleted], [Name], [Phone])
OUTPUT INSERTED.[SupplierId]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-03-09 14:00:00.559 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:00:00.563 +07:00 [INF] Executed action Warehouse_Management.Controllers.SupplierController.CreateSupplier (Warehouse Management) in 69.7883ms
2025-03-09 14:00:00.564 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.SupplierController.CreateSupplier (Warehouse Management)'
2025-03-09 14:00:00.566 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Supplier - 201 null application/json; charset=utf-8 89.8628ms
2025-03-09 14:00:29.451 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Shelf - application/json 92
2025-03-09 14:00:29.461 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:00:29.463 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 14:00:29.468 +07:00 [INF] Route matched with {action = "CreateShelf", controller = "Shelf"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateShelf(Warehouse_Management.Models.DTO.Shelf.CreateShelfDTO) on controller Warehouse_Management.Controllers.ShelfController (Warehouse Management).
2025-03-09 14:00:29.492 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 14:00:29.506 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__code_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Shelves] AS [s]
        WHERE [s].[Code] = @__code_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 14:00:29.545 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Shelves] ([Capacity], [Code], [CreatedAt], [IsActive], [Location], [Name], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ShelfId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:00:29.554 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:00:29.557 +07:00 [INF] Executed action Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management) in 87.5955ms
2025-03-09 14:00:29.559 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 14:00:29.563 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Shelf - 201 null application/json; charset=utf-8 112.0326ms
2025-03-09 14:01:04.566 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Shelf - application/json 96
2025-03-09 14:01:04.575 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:01:04.577 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 14:01:04.578 +07:00 [INF] Route matched with {action = "CreateShelf", controller = "Shelf"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateShelf(Warehouse_Management.Models.DTO.Shelf.CreateShelfDTO) on controller Warehouse_Management.Controllers.ShelfController (Warehouse Management).
2025-03-09 14:01:04.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 14:01:04.592 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__code_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Shelves] AS [s]
        WHERE [s].[Code] = @__code_0) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 14:01:04.596 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Shelves] ([Capacity], [Code], [CreatedAt], [IsActive], [Location], [Name], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ShelfId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:01:04.599 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:01:04.600 +07:00 [INF] Executed action Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management) in 19.3019ms
2025-03-09 14:01:04.602 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ShelfController.CreateShelf (Warehouse Management)'
2025-03-09 14:01:04.603 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Shelf - 201 null application/json; charset=utf-8 37.4485ms
2025-03-09 14:01:10.672 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Shelf?pageNumber=1&pageSize=10 - null null
2025-03-09 14:01:10.676 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management)'
2025-03-09 14:01:10.684 +07:00 [INF] Route matched with {action = "GetAllShelves", controller = "Shelf"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllShelves(Int32, Int32) on controller Warehouse_Management.Controllers.ShelfController (Warehouse Management).
2025-03-09 14:01:10.706 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Shelves] AS [s]
2025-03-09 14:01:10.718 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 14:01:10.719 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 14:01:10.751 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[ShelfId], [s0].[Capacity], [s0].[Code], [s0].[CreatedAt], [s0].[IsActive], [s0].[Location], [s0].[Name], [s0].[UpdatedAt], [s0].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM (
    SELECT [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId]
    FROM [Shelves] AS [s]
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [s0]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s0].[UserId] = [a0].[Id]
2025-03-09 14:01:10.763 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:01:10.767 +07:00 [INF] Executed action Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management) in 81.0841ms
2025-03-09 14:01:10.768 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management)'
2025-03-09 14:01:10.769 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Shelf?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 98.1165ms
2025-03-09 14:01:27.850 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Auth - null null
2025-03-09 14:01:27.853 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 14:01:27.862 +07:00 [INF] Route matched with {action = "GetAllUser", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUser() on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 14:01:27.878 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
2025-03-09 14:01:27.887 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:01:27.891 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:01:27.895 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:01:27.897 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:01:27.902 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management) in 37.8712ms
2025-03-09 14:01:27.904 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 14:01:27.905 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Auth - 200 null application/json; charset=utf-8 56.1168ms
2025-03-09 14:01:37.396 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 290
2025-03-09 14:01:37.399 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:01:37.400 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:01:37.407 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 14:01:37.428 +07:00 [INF] Fetching Supplier with ID: 1
2025-03-09 14:01:37.439 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 14:01:37.452 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 14:01:37.458 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:01:37.476 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Shelves] AS [s]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s].[UserId] = [a0].[Id]
WHERE [s].[ShelfId] = @__id_0
2025-03-09 14:01:37.515 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 14:01:37.546 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Lots] ([CreateAt], [ExpiryDate], [LotCode], [ManufactureDate], [ProductId], [Quantity], [ShelfId], [Status], [UpdateAt], [UserId])
OUTPUT INSERTED.[LotId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-03-09 14:01:37.555 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 14:01:37.597 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-03-09 14:01:37.608 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
2025-03-09 14:01:37.611 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:01:37.615 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 205.5153ms
2025-03-09 14:01:37.616 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:01:37.617 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 201 null application/json; charset=utf-8 221.6696ms
2025-03-09 14:02:06.161 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 14:02:06.169 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:02:06.171 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 14:02:06.175 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 14:02:06.178 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 14:02:06.181 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 14:02:06.183 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 14:02:06.185 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 12.9938ms
2025-03-09 14:02:06.191 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:02:06.192 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 31.1167ms
2025-03-09 14:02:45.583 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Platform - application/json 68
2025-03-09 14:02:45.591 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:02:45.592 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management)'
2025-03-09 14:02:45.596 +07:00 [INF] Route matched with {action = "CreatePlatform", controller = "Platform"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreatePlatform(Warehouse_Management.Models.DTO.Platform.CreatePlatformDTO) on controller Warehouse_Management.Controllers.PlatformController (Warehouse Management).
2025-03-09 14:02:45.620 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Platforms] ([ApiKey], [IsActive], [Name])
OUTPUT INSERTED.[PlatformId]
VALUES (@p0, @p1, @p2);
2025-03-09 14:02:45.630 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:02:45.632 +07:00 [INF] Executed action Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management) in 34.3641ms
2025-03-09 14:02:45.634 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.PlatformController.CreatePlatform (Warehouse Management)'
2025-03-09 14:02:45.635 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Platform - 201 null application/json; charset=utf-8 51.3114ms
2025-03-09 14:03:08.384 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Order - application/json 226
2025-03-09 14:03:08.420 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:03:08.421 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 14:03:08.425 +07:00 [INF] Route matched with {action = "CreateOrder", controller = "Order"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateOrder(Warehouse_Management.Models.DTO.Order.CreateOrderDTO) on controller Warehouse_Management.Controllers.OrderController (Warehouse Management).
2025-03-09 14:03:08.443 +07:00 [INF] 🚀 Starting CreateOrderAsync...
2025-03-09 14:03:08.444 +07:00 [INF] 📌 Dictionary initialized successfully.
2025-03-09 14:03:08.448 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 14:03:08.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[ProductId] = @__id_0
2025-03-09 14:03:08.473 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 14:03:08.481 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 14:03:08.489 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450), @p11='?' (DbType = Int32), @p12='?' (DbType = Int32), @p13='?' (DbType = Int32), @p14='?' (DbType = Int32), @p15='?' (DbType = DateTime2), @p16='?' (Size = 4000), @p17='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p11, @p12, @p13, @p14, @p15, @p16, @p17);
2025-03-09 14:03:08.537 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (DbType = Boolean), @p3='?' (DbType = Int32), @p4='?' (Size = 4000), @p5='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Orders] ([CreatedAt], [OrderDate], [OrderStatus], [PlatformId], [PlatformOrderId], [TotalAmount])
OUTPUT INSERTED.[OrderId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
2025-03-09 14:03:08.547 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p7='?' (DbType = Int32), @p8='?' (DbType = Int32), @p9='?' (Precision = 18) (Scale = 2) (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [OrderItems] ([OrderId], [ProductId], [Quantity], [UnitPrice])
OUTPUT INSERTED.[OrderItemId]
VALUES (@p6, @p7, @p8, @p9);
2025-03-09 14:03:08.556 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:03:08.566 +07:00 [INF] Executed action Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management) in 139.5261ms
2025-03-09 14:03:08.569 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.OrderController.CreateOrder (Warehouse Management)'
2025-03-09 14:03:08.570 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Order - 201 null application/json; charset=utf-8 186.5738ms
2025-03-09 14:03:13.332 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 14:03:13.339 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:03:13.341 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 14:03:13.347 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 14:03:13.350 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 14:03:13.353 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 14:03:13.355 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 14:03:13.356 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 11.9054ms
2025-03-09 14:03:13.357 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:03:13.358 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 26.1195ms
2025-03-09 14:18:50.013 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:18:50.038 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:18:50.040 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:18:50.266 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 14:18:50.283 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 14:18:50.290 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 14:18:50.441 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Products] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 14:18:50.446 +07:00 [INF] Products table already contains data, no seed required.
2025-03-09 14:18:50.466 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 14:18:50.595 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 14:18:50.595 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 14:18:50.660 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 14:18:50.661 +07:00 [INF] Hosting environment: Development
2025-03-09 14:18:50.663 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 14:18:50.991 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 14:18:51.118 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 136.2742ms
2025-03-09 14:18:51.141 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 14:18:51.141 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 14:18:51.141 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 14:18:51.147 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 6.6658ms
2025-03-09 14:18:51.151 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 10.3803ms
2025-03-09 14:18:51.178 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.229ms
2025-03-09 14:18:51.339 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 14:18:51.363 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 23.7694ms
2025-03-09 14:18:55.751 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 14:18:55.804 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:18:55.819 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 14:18:55.856 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 14:18:55.865 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 14:18:55.870 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 14:18:55.876 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 14:18:55.884 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 58.9142ms
2025-03-09 14:18:55.885 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:18:55.889 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 138.118ms
2025-03-09 14:19:35.915 +07:00 [WRN] No store type was specified for the decimal property 'TotalAmount' on entity type 'Order'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:19:35.936 +07:00 [WRN] No store type was specified for the decimal property 'UnitPrice' on entity type 'OrderItem'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:19:35.937 +07:00 [WRN] No store type was specified for the decimal property 'BasePrice' on entity type 'Product'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-03-09 14:19:36.161 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-03-09 14:19:36.176 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-03-09 14:19:36.184 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-03-09 14:19:36.338 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [Products] AS [p]) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2025-03-09 14:19:36.343 +07:00 [INF] Products table already contains data, no seed required.
2025-03-09 14:19:36.362 +07:00 [INF] User profile is available. Using 'C:\Users\tiend\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-03-09 14:19:36.494 +07:00 [INF] Now listening on: https://localhost:7190
2025-03-09 14:19:36.495 +07:00 [INF] Now listening on: http://localhost:5299
2025-03-09 14:19:36.558 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-03-09 14:19:36.559 +07:00 [INF] Hosting environment: Development
2025-03-09 14:19:36.561 +07:00 [INF] Content root path: C:\Users\tiend\OneDrive\Desktop\SWD392\src be\Warehouse Management
2025-03-09 14:19:37.017 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.html - null null
2025-03-09 14:19:37.134 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.html - 200 null text/html;charset=utf-8 122.196ms
2025-03-09 14:19:37.147 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/index.js - null null
2025-03-09 14:19:37.147 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - null null
2025-03-09 14:19:37.152 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/_vs/browserLink - null null
2025-03-09 14:19:37.156 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/index.js - 200 null application/javascript;charset=utf-8 8.5217ms
2025-03-09 14:19:37.173 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_framework/aspnetcore-browser-refresh.js - 200 16525 application/javascript; charset=utf-8 25.9998ms
2025-03-09 14:19:37.199 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.3124ms
2025-03-09 14:19:37.380 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - null null
2025-03-09 14:19:37.408 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 28.4957ms
2025-03-09 14:19:41.745 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 14:19:41.798 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:19:41.810 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 14:19:41.848 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 14:19:41.856 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 14:19:41.860 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 14:19:41.876 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([l].[Quantity]), 0)
FROM [Lots] AS [l]
2025-03-09 14:19:41.881 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`4[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 14:19:41.888 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 73.9191ms
2025-03-09 14:19:41.890 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:19:41.893 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 148.9551ms
2025-03-09 14:20:33.998 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Shelf?pageNumber=1&pageSize=10 - null null
2025-03-09 14:20:34.008 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management)'
2025-03-09 14:20:34.022 +07:00 [INF] Route matched with {action = "GetAllShelves", controller = "Shelf"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllShelves(Int32, Int32) on controller Warehouse_Management.Controllers.ShelfController (Warehouse Management).
2025-03-09 14:20:34.306 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Shelves] AS [s]
2025-03-09 14:20:34.344 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 14:20:34.345 +07:00 [WRN] The query uses a row limiting operator ('Skip'/'Take') without an 'OrderBy' operator. This may lead to unpredictable results. If the 'Distinct' operator is used after 'OrderBy', then make sure to use the 'OrderBy' operator after 'Distinct' as the ordering would otherwise get erased.
2025-03-09 14:20:34.462 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[@__p_0='?' (DbType = Int32), @__p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [s0].[ShelfId], [s0].[Capacity], [s0].[Code], [s0].[CreatedAt], [s0].[IsActive], [s0].[Location], [s0].[Name], [s0].[UpdatedAt], [s0].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM (
    SELECT [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId]
    FROM [Shelves] AS [s]
    ORDER BY (SELECT 1)
    OFFSET @__p_0 ROWS FETCH NEXT @__p_1 ROWS ONLY
) AS [s0]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s0].[UserId] = [a0].[Id]
2025-03-09 14:20:34.585 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:20:34.608 +07:00 [INF] Executed action Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management) in 584.3757ms
2025-03-09 14:20:34.610 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ShelfController.GetAllShelves (Warehouse Management)'
2025-03-09 14:20:34.613 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Shelf?pageNumber=1&pageSize=10 - 200 null application/json; charset=utf-8 617.5505ms
2025-03-09 14:20:47.343 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 290
2025-03-09 14:20:47.348 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:20:47.351 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:20:47.356 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 14:20:47.399 +07:00 [INF] Fetching Supplier with ID: 1
2025-03-09 14:20:47.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 14:20:47.453 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 14:20:47.651 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:20:47.705 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2a8df480-21fd-4072-b4e7-5320e22259dd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2a8df480-21fd-4072-b4e7-5320e22259dd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 14:20:47.836 +07:00 [ERR] An error occurred while processing the product creation: An error occurred while saving the entity changes. See the inner exception for details.
2025-03-09 14:20:47.855 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:20:47.858 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 501.2302ms
2025-03-09 14:20:47.860 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:20:47.862 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 500 null application/json; charset=utf-8 518.4771ms
2025-03-09 14:20:56.820 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 296
2025-03-09 14:20:56.825 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:20:56.827 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:20:56.828 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 14:20:56.833 +07:00 [INF] Fetching Supplier with ID: 1
2025-03-09 14:20:56.840 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 14:20:56.844 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 14:20:56.851 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:20:56.857 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'Warehouse_Management.Data.WareHouseDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2a8df480-21fd-4072-b4e7-5320e22259dd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Products_AspNetUsers_UserId". The conflict occurred in database "WarehouseManagerment", table "dbo.AspNetUsers", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2a8df480-21fd-4072-b4e7-5320e22259dd
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-03-09 14:20:56.938 +07:00 [ERR] An error occurred while processing the product creation: An error occurred while saving the entity changes. See the inner exception for details.
2025-03-09 14:20:56.940 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:20:56.942 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 111.0502ms
2025-03-09 14:20:56.949 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:20:56.955 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 500 null application/json; charset=utf-8 135.5499ms
2025-03-09 14:21:06.182 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Auth - null null
2025-03-09 14:21:06.186 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 14:21:06.191 +07:00 [INF] Route matched with {action = "GetAllUser", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllUser() on controller Warehouse_Management.Controllers.AuthController (Warehouse Management).
2025-03-09 14:21:06.208 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
2025-03-09 14:21:06.233 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:21:06.240 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:21:06.244 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [a0].[Name]
FROM [AspNetUserRoles] AS [a]
INNER JOIN [AspNetRoles] AS [a0] ON [a].[RoleId] = [a0].[Id]
WHERE [a].[UserId] = @__userId_0
2025-03-09 14:21:06.246 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:21:06.253 +07:00 [INF] Executed action Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management) in 60.8293ms
2025-03-09 14:21:06.255 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.AuthController.GetAllUser (Warehouse Management)'
2025-03-09 14:21:06.257 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Auth - 200 null application/json; charset=utf-8 75.4818ms
2025-03-09 14:21:29.255 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - application/json 295
2025-03-09 14:21:29.267 +07:00 [INF] CORS policy execution successful.
2025-03-09 14:21:29.268 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:21:29.269 +07:00 [INF] Route matched with {action = "CreateProductBySupplier", controller = "Product"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CreateProductBySupplier(Warehouse_Management.Models.DTO.Product.CreateProductFromTransaction) on controller Warehouse_Management.Controllers.ProductController (Warehouse Management).
2025-03-09 14:21:29.285 +07:00 [INF] Fetching Supplier with ID: 1
2025-03-09 14:21:29.290 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[SupplierId], [s].[CreateAt], [s].[Email], [s].[IsDeleted], [s].[Name], [s].[Phone]
FROM [Suppliers] AS [s]
WHERE [s].[SupplierId] = @__id_0
2025-03-09 14:21:29.299 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__sku_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId]
FROM [Products] AS [p]
WHERE [p].[SKU] = @__sku_0
2025-03-09 14:21:29.303 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@p0='?' (Size = 4000), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (DbType = DateTime2), @p7='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Products] ([Barcode], [BasePrice], [CreatedAt], [Description], [ProductName], [SKU], [UpdatedAt], [UserId])
OUTPUT INSERTED.[ProductId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-03-09 14:21:29.338 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Shelves] AS [s]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [s].[UserId] = [a0].[Id]
WHERE [s].[ShelfId] = @__id_0
2025-03-09 14:21:29.379 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__productId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [l].[LotId], [l].[CreateAt], [l].[ExpiryDate], [l].[LotCode], [l].[ManufactureDate], [l].[ProductId], [l].[Quantity], [l].[ShelfId], [l].[Status], [l].[UpdateAt], [l].[UserId], [p].[ProductId], [p].[Barcode], [p].[BasePrice], [p].[CreatedAt], [p].[Description], [p].[ProductName], [p].[SKU], [p].[UpdatedAt], [p].[UserId], [s].[ShelfId], [s].[Capacity], [s].[Code], [s].[CreatedAt], [s].[IsActive], [s].[Location], [s].[Name], [s].[UpdatedAt], [s].[UserId], [a0].[Id], [a0].[AccessFailedCount], [a0].[ConcurrencyStamp], [a0].[Discriminator], [a0].[Email], [a0].[EmailConfirmed], [a0].[LockoutEnabled], [a0].[LockoutEnd], [a0].[NormalizedEmail], [a0].[NormalizedUserName], [a0].[PasswordHash], [a0].[PhoneNumber], [a0].[PhoneNumberConfirmed], [a0].[SecurityStamp], [a0].[TwoFactorEnabled], [a0].[UserName], [a0].[Status]
FROM [Lots] AS [l]
INNER JOIN [Products] AS [p] ON [l].[ProductId] = [p].[ProductId]
INNER JOIN [Shelves] AS [s] ON [l].[ShelfId] = [s].[ShelfId]
LEFT JOIN (
    SELECT [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
    FROM [AspNetUsers] AS [a]
    WHERE [a].[Discriminator] = N'ApplicationUser'
) AS [a0] ON [l].[UserId] = [a0].[Id]
WHERE [l].[ProductId] = @__productId_0 AND [l].[Quantity] > 0
ORDER BY [l].[ManufactureDate]
2025-03-09 14:21:29.433 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Lots] ([CreateAt], [ExpiryDate], [LotCode], [ManufactureDate], [ProductId], [Quantity], [ShelfId], [Status], [UpdateAt], [UserId])
OUTPUT INSERTED.[LotId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9);
2025-03-09 14:21:29.459 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Discriminator], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName], [a].[Status]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__p_0
2025-03-09 14:21:29.499 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime2), @p5='?' (Size = 4000), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [StockTransactions] ([LotId], [ProductId], [Quantity], [SupplierId], [TransactionDate], [Type], [UserId])
OUTPUT INSERTED.[TransactionId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
2025-03-09 14:21:29.513 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p10='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = DateTime2), @p2='?' (Size = 4000), @p3='?' (DbType = DateTime2), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32), @p7='?' (DbType = Boolean), @p8='?' (DbType = DateTime2), @p9='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Lots] SET [CreateAt] = @p0, [ExpiryDate] = @p1, [LotCode] = @p2, [ManufactureDate] = @p3, [ProductId] = @p4, [Quantity] = @p5, [ShelfId] = @p6, [Status] = @p7, [UpdateAt] = @p8, [UserId] = @p9
OUTPUT 1
WHERE [LotId] = @p10;
2025-03-09 14:21:29.516 +07:00 [INF] Executing ObjectResult, writing value of type 'Warehouse_Management.Helpers.ApiResponse'.
2025-03-09 14:21:29.520 +07:00 [INF] Executed action Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management) in 249.2406ms
2025-03-09 14:21:29.522 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.ProductController.CreateProductBySupplier (Warehouse Management)'
2025-03-09 14:21:29.523 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7190/api/Product/createProductBySUppliers - 201 null application/json; charset=utf-8 268.2241ms
2025-03-09 14:21:50.599 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7190/api/Dashboard - null null
2025-03-09 14:21:50.612 +07:00 [INF] Executing endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:21:50.613 +07:00 [INF] Route matched with {action = "GetDashboardData", controller = "Dashboard"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetDashboardData() on controller Warehouse_Management.Controllers.DashboardController (Warehouse Management).
2025-03-09 14:21:50.618 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Orders] AS [o]
2025-03-09 14:21:50.622 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [AspNetUsers] AS [a]
2025-03-09 14:21:50.625 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COUNT(*)
FROM [Products] AS [p]
2025-03-09 14:21:50.628 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT COALESCE(SUM([l].[Quantity]), 0)
FROM [Lots] AS [l]
2025-03-09 14:21:50.630 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`4[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-03-09 14:21:50.631 +07:00 [INF] Executed action Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management) in 15.7289ms
2025-03-09 14:21:50.632 +07:00 [INF] Executed endpoint 'Warehouse_Management.Controllers.DashboardController.GetDashboardData (Warehouse Management)'
2025-03-09 14:21:50.638 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7190/api/Dashboard - 200 null application/json; charset=utf-8 39.2171ms
